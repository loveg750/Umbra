[
  {
    "id": "CLOUD-ROOT-ACCESS-KEY-CREATED",
    "name": "Root or admin created new access key",
    "description": "New access key created by a root or admin-like principal, often abused for persistence.",
    "severity": "critical",
    "log_type": "cloud",
    "dialect": "aws_cloudtrail",
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "cloud" },
      { "field": "action", "operator": "contains", "value": "CreateAccessKey" },
      { "field": "actor", "operator": "contains", "value": "root" }
    ],
    "tags": ["cloud", "iam", "persistence", "dialect", "aws"],
    "mitre": ["T1098"]
  },
  {
    "id": "CLOUD-UNUSUAL-REGION-ACTION",
    "name": "Cloud admin action from unusual region",
    "description": "Cloud management action executed from a rare or unexpected region.",
    "severity": "high",
    "log_type": "cloud",
    "dialect": "aws_cloudtrail",
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "cloud" },
      { "field": "action", "operator": "contains", "value": "ConsoleLogin" },
      { "field": "location", "operator": "not_in", "value": ["us-east-1", "us-west-2", "eu-west-1"] }
    ],
    "tags": ["cloud", "geo_anomaly", "aws", "dialect"],
    "mitre": ["T1078", "T1090"]
  },
  {
    "id": "CLOUD-S3-PUBLIC-ACL",
    "name": "Object or bucket made publicly readable",
    "description": "S3 or storage object ACL modified to allow public read access.",
    "severity": "high",
    "log_type": "cloud",
    "dialect": "aws_cloudtrail",
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "cloud" },
      { "field": "action", "operator": "contains", "value": "PutBucketAcl" },
      { "field": "description", "operator": "contains", "value": "public" }
    ],
    "tags": ["cloud", "exposure", "s3", "dialect"],
    "mitre": ["T1530"]
  },

  {
    "id": "CLOUD-AWS-MFA-DISABLED-ADMIN-01",
    "name": "MFA disabled on privileged AWS account",
    "description": "AWS CloudTrail event showing MFA disabled or removed for a privileged or admin user.",
    "severity": "critical",
    "log_type": "cloud",
    "dialect": "aws_cloudtrail",
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "cloud" },
      { "field": "action", "operator": "contains", "value": "DeactivateMFADevice" },
      { "field": "user_type", "operator": "in", "value": ["Root", "Admin", "PowerUser"] }
    ],
    "tags": ["cloud", "iam", "mfa", "hardening-bypass", "dialect", "aws"],
    "mitre": ["T1556", "T1078"]
  },
  {
    "id": "CLOUD-AWS-CLOUDTRAIL-DISABLED-01",
    "name": "CloudTrail or logging disabled",
    "description": "Disabling or modifying audit logging in AWS, often a precursor to stealthy activity.",
    "severity": "critical",
    "log_type": "cloud",
    "dialect": "aws_cloudtrail",
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "cloud" },
      { "field": "action", "operator": "in", "value": ["StopLogging", "DeleteTrail", "UpdateTrail"] },
      { "field": "resource_type", "operator": "contains", "value": "CloudTrail" }
    ],
    "tags": ["cloud", "logging", "evasion", "dialect", "aws"],
    "mitre": ["T1562"]
  },
  {
    "id": "CLOUD-AWS-S3-BULK-DOWNLOAD-01",
    "name": "Suspicious bulk S3 object access",
    "description": "High volume of S3 object reads from a single principal, suggesting data collection or exfiltration.",
    "severity": "high",
    "log_type": "cloud",
    "dialect": "aws_cloudtrail",
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "cloud" },
      { "field": "action", "operator": "contains", "value": "GetObject" },
      { "field": "object_count_window", "operator": "greater_than", "value": 100 }
    ],
    "tags": ["cloud", "exfiltration", "s3", "dialect", "aws"],
    "mitre": ["T1530", "T1567"]
  },

  {
    "id": "CLOUD-AZURE-ROLE-ASSIGNMENT-OWNER-01",
    "name": "Azure privileged role assignment",
    "description": "New role assignment granting Owner or Contributor permissions to a principal.",
    "severity": "high",
    "log_type": "cloud",
    "dialect": "azure_activity",
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "cloud" },
      { "field": "cloud_provider", "operator": "equals", "value": "azure" },
      { "field": "operation_name", "operator": "contains", "value": "roleAssignments/write" },
      { "field": "role_name", "operator": "in", "value": ["Owner", "Contributor", "User Access Administrator"] }
    ],
    "tags": ["cloud", "iam", "privilege-escalation", "azure", "dialect"],
    "mitre": ["T1098", "T1078"]
  },
  {
    "id": "CLOUD-AZURE-SECURITY-CENTER-DISABLED-01",
    "name": "Azure security features disabled",
    "description": "Disabling Azure Defender or key security features in Azure subscriptions.",
    "severity": "critical",
    "log_type": "cloud",
    "dialect": "azure_activity",
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "cloud" },
      { "field": "cloud_provider", "operator": "equals", "value": "azure" },
      { "field": "operation_name", "operator": "contains", "value": "Microsoft.Security/pricings/write" },
      { "field": "new_pricing_tier", "operator": "equals", "value": "Free" }
    ],
    "tags": ["cloud", "logging", "defense-evasion", "azure", "dialect"],
    "mitre": ["T1562"]
  },

  {
    "id": "CLOUD-GCP-SERVICE-ACCOUNT-KEY-CREATED-01",
    "name": "GCP service account key created",
    "description": "Creation of a new GCP service account key, often used for long-lived, scriptable access.",
    "severity": "high",
    "log_type": "cloud",
    "dialect": "gcp_audit",
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "cloud" },
      { "field": "cloud_provider", "operator": "equals", "value": "gcp" },
      { "field": "method_name", "operator": "contains", "value": "google.iam.admin.v1.CreateServiceAccountKey" }
    ],
    "tags": ["cloud", "iam", "service-account", "gcp", "dialect"],
    "mitre": ["T1098"]
  },
  {
    "id": "CLOUD-GCP-STORAGE-BUCKET-PUBLIC-01",
    "name": "GCP storage bucket public access",
    "description": "Google Cloud Storage bucket policy modified to allow public or allUsers access.",
    "severity": "high",
    "log_type": "cloud",
    "dialect": "gcp_audit",
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "cloud" },
      { "field": "cloud_provider", "operator": "equals", "value": "gcp" },
      { "field": "resource_type", "operator": "contains", "value": "storage.googleapis.com/Bucket" },
      { "field": "policy_binding_principal", "operator": "in", "value": ["allUsers", "allAuthenticatedUsers"] }
    ],
    "tags": ["cloud", "exposure", "gcp", "dialect"],
    "mitre": ["T1530"]
  },

  {
    "id": "CLOUD-O365-INBOX-FORWARDING-EXTERNAL-01",
    "name": "Suspicious external inbox forwarding",
    "description": "User mailbox configured to auto-forward all mail to an external address, common in BEC campaigns.",
    "severity": "high",
    "log_type": "cloud",
    "dialect": "o365_unified_audit",
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "cloud" },
      { "field": "workload", "operator": "equals", "value": "Exchange" },
      { "field": "operation", "operator": "contains", "value": "New-InboxRule" },
      { "field": "forward_to_external", "operator": "equals", "value": true }
    ],
    "tags": ["cloud", "o365", "bec", "exfiltration", "dialect"],
    "mitre": ["T1114", "T1567"]
  },

  {
    "id": "CLOUD-GENERIC-UNUSUAL-SAAS-LOGIN-01",
    "name": "Unusual SaaS admin login",
    "description": "Admin or global admin logs into SaaS platform from new device fingerprint, ASN, or country.",
    "severity": "high",
    "log_type": "cloud",
    "dialect": "saas_generic",
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "cloud" },
      { "field": "user_role", "operator": "in", "value": ["GlobalAdmin", "OrgAdmin", "Owner"] },
      { "field": "login_new_geo", "operator": "equals", "value": true },
      { "field": "login_new_device", "operator": "equals", "value": true }
    ],
    "tags": ["cloud", "saas", "anomalous-login", "dialect"],
    "mitre": ["T1078"]
  },

  {
    "id": "CLOUD-NORMALIZED-DATA-EXFIL-01",
    "name": "Normalized cloud data exfiltration pattern",
    "description": "Umbraâ€™s normalized view shows high-volume data transfer from cloud storage to an untrusted or user-owned destination.",
    "severity": "high",
    "log_type": "cloud",
    "dialect": "normalized",
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "cloud" },
      { "field": "normalized_action", "operator": "equals", "value": "data_download" },
      { "field": "bytes_out", "operator": "greater_than", "value": 1000000000 },
      { "field": "destination_trust", "operator": "equals", "value": "untrusted" }
    ],
    "tags": ["cloud", "exfiltration", "normalized", "dialect"],
    "mitre": ["T1567", "T1041"]
  }
]
