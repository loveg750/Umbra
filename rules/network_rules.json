[
  {
    "id": "NETWORK_BEACONING_01",
    "name": "Suspicious Periodic Beaconing",
    "log_type": "network",
    "severity": "high",
    "description": "Regular, periodic outbound connections from a host to the same external endpoint, suggesting command-and-control beaconing.",
    "mitre": ["T1071", "T1105"],
    "tags": ["network", "beaconing", "c2", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "network" },
      { "field": "event", "operator": "contains", "value": "suspicious periodic beaconing" }
    ]
  },
  {
    "id": "C2_KNOWN_BAD_01",
    "name": "Beaconing to Known Malicious Infrastructure",
    "log_type": "network",
    "severity": "critical",
    "description": "Outbound connections to IPs or domains that are known to belong to malicious infrastructure (threat intel hits).",
    "mitre": ["T1071", "T1105"],
    "tags": ["network", "c2", "threat_intel", "known-bad"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "network" },
      { "field": "event", "operator": "contains", "value": "known malicious infrastructure" }
    ]
  },
  {
    "id": "RARE_EXTERNAL_HOST_01",
    "name": "Rare External Host Communication",
    "log_type": "network",
    "severity": "high",
    "description": "Hosts communicating with domains or IPs that have not been seen in the environment before and may be newly registered.",
    "mitre": ["T1071"],
    "tags": ["network", "rare-destination", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "network" },
      { "field": "event", "operator": "contains", "value": "rare external host communication" }
    ]
  },
  {
    "id": "ANOMALOUS_EGRESS_01",
    "name": "Anomalous Egress Volume",
    "log_type": "network",
    "severity": "high",
    "description": "Outbound traffic volume from a host exceeds its typical baseline by a significant margin.",
    "mitre": ["T1041"],
    "tags": ["network", "exfiltration", "egress", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "network" },
      { "field": "bytes_sent", "operator": "greater_than", "value": 100000000 }
    ]
  },
  {
    "id": "DNS_TUNNELING_02",
    "name": "Potential DNS Tunneling Activity",
    "log_type": "network",
    "severity": "critical",
    "description": "Long, high-frequency DNS queries that resemble encoded data being tunneled through DNS.",
    "mitre": ["T1071.004", "T1041"],
    "tags": ["network", "dns-tunnel", "covert-channel", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "network" },
      { "field": "event", "operator": "contains", "value": "dns tunneling detected" }
    ]
  },
  {
    "id": "PORT_SCAN_01",
    "name": "Possible Port Scanning Activity",
    "log_type": "network",
    "severity": "medium",
    "description": "Single source scanning multiple ports or multiple hosts in a short period of time.",
    "mitre": ["T1046"],
    "tags": ["network", "recon", "port-scan", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "network" },
      { "field": "event", "operator": "contains", "value": "possible port scanning activity" }
    ]
  },
  {
    "id": "LATERAL_MOVEMENT_PORT_USAGE_01",
    "name": "Suspicious Lateral Movement Ports",
    "log_type": "network",
    "severity": "high",
    "description": "Use of SMB, WMI, RDP, or WinRM ports in patterns inconsistent with normal administrative behavior.",
    "mitre": ["T1021.001", "T1021.002", "T1021.006"],
    "tags": ["network", "lateral-movement", "admin-ports", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "network" },
      { "field": "event", "operator": "contains", "value": "suspicious lateral movement ports" }
    ]
  },
  {
    "id": "ANON_NETWORK_USAGE_01",
    "name": "Anonymous Network Usage (Tor/Proxy/VPN)",
    "log_type": "network",
    "severity": "medium",
    "description": "Traffic from internal hosts to known Tor exit nodes, public proxies, or suspicious VPN exit IPs.",
    "mitre": ["T1090"],
    "tags": ["network", "anonymization", "tor", "vpn", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "network" },
      { "field": "event", "operator": "contains", "value": "anonymous network usage" }
    ]
  },
  {
    "id": "DGA_SUSPICIOUS_DOMAIN_01",
    "name": "Suspicious Algorithmic Domain Activity",
    "log_type": "network",
    "severity": "high",
    "description": "Frequent communication with domains that appear auto-generated (DGA), often used by malware.",
    "mitre": ["T1568"],
    "tags": ["network", "dga", "malware-infra", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "network" },
      { "field": "event", "operator": "contains", "value": "suspicious algorithmic domain activity" }
    ]
  },
  {
    "id": "MALWARE_DOWNLOAD_01",
    "name": "Suspicious File Download from Untrusted Source",
    "log_type": "network",
    "severity": "high",
    "description": "Download of executable or script files from untrusted or newly registered domains.",
    "mitre": ["T1105", "T1104"],
    "tags": ["network", "malware-download", "delivery", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "network" },
      { "field": "event", "operator": "contains", "value": "suspicious file download from untrusted source" }
    ]
  },
  {
    "id": "BOTNET_TRAFFIC_01",
    "name": "Botnet-Like Traffic Pattern",
    "log_type": "network",
    "severity": "high",
    "description": "Traffic patterns resembling botnet behavior, such as periodic small beacons combined with occasional bulk data transfer or command retrieval.",
    "mitre": ["T1071", "T1105"],
    "tags": ["network", "botnet", "c2", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "network" },
      { "field": "event", "operator": "contains", "value": "botnet-like traffic pattern" }
    ]
  },
  {
    "id": "INSIDER_PROXY_EXFIL_01",
    "name": "Proxy-Assisted Data Exfiltration",
    "log_type": "network",
    "severity": "high",
    "description": "User or host sending large outbound transfers through web proxies or HTTPS tunnels to unfamiliar external endpoints.",
    "mitre": ["T1041", "T1090"],
    "tags": ["network", "exfiltration", "proxy", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "network" },
      { "field": "event", "operator": "contains", "value": "proxy-assisted data exfiltration" }
    ]
  },

  {
    "id": "NETWORK_LABEL_MALICIOUS_01",
    "name": "Network Flow Marked as Malicious (Labeled Data)",
    "log_type": "network",
    "severity": "high",
    "description": "Network record explicitly labeled as malicious in a labeled dataset (e.g., Zeek-style or Kaggle training logs).",
    "mitre": ["T1041", "T1071"],
    "tags": ["network", "labeled-data", "training-set", "scenario"],
    "conditions": [
      { "field": "label", "operator": "contains", "value": "Malicious" }
    ]
  },
  {
    "id": "NETWORK_LABEL_PORTSCAN_01",
    "name": "Labeled Port Scanning Activity",
    "log_type": "network",
    "severity": "medium",
    "description": "Network connection explicitly labeled as part of a horizontal or vertical port scan in training or research data.",
    "mitre": ["T1046"],
    "tags": ["network", "port-scan", "labeled-data"],
    "conditions": [
      { "field": "label", "operator": "contains", "value": "PortScan" }
    ]
  },
  {
    "id": "NETWORK_ZEEK_PORTSCAN_DETAIL_01",
    "name": "Zeek Detailed Port Scan Label",
    "log_type": "network",
    "severity": "medium",
    "description": "Zeek-style connection log row whose detailed label indicates horizontal port scanning behavior.",
    "mitre": ["T1046"],
    "tags": ["network", "zeek", "port-scan"],
    "conditions": [
      { "field": "detailed-label", "operator": "contains", "value": "HorizontalPortScan" }
    ]
  },
  {
    "id": "NETWORK_KNOWN_BAD_REPUTATION_01",
    "name": "Destination with Malicious Reputation",
    "log_type": "network",
    "severity": "critical",
    "description": "Traffic to a host or domain with reputation marked as malicious by an enrichment pipeline.",
    "mitre": ["T1071", "T1105"],
    "tags": ["network", "c2", "threat_intel"],
    "conditions": [
      { "field": "dst_rep", "operator": "equals", "value": "malicious" }
    ]
  },
  {
    "id": "NETWORK_SUSPICIOUS_EGRESS_COUNTRY_01",
    "name": "Unusual Egress to High-Risk Country",
    "log_type": "network",
    "severity": "high",
    "description": "Outbound connection from an internal host to a country outside the normal business regions.",
    "mitre": ["T1041"],
    "tags": ["network", "geo-anomaly", "exfiltration"],
    "conditions": [
      { "field": "direction", "operator": "equals", "value": "outbound" },
      { "field": "dst_country", "operator": "not_in", "value": ["US", "CA", "GB", "DE", "FR"] }
    ]
  },
  {
    "id": "NETWORK_INTERNAL_RDP_LATERAL_01",
    "name": "Internal RDP Lateral Movement",
    "log_type": "network",
    "severity": "high",
    "description": "Internal-to-internal RDP traffic that may represent lateral movement within the environment.",
    "mitre": ["T1021.001"],
    "tags": ["network", "lateral-movement", "rdp"],
    "conditions": [
      { "field": "is_internal_src", "operator": "equals", "value": true },
      { "field": "is_internal_dst", "operator": "equals", "value": true },
      { "field": "dst_port", "operator": "equals", "value": 3389 }
    ]
  },
  {
    "id": "NETWORK_HTTP_CLEAR_CREDENTIALS_01",
    "name": "Login Over Unencrypted HTTP",
    "log_type": "network",
    "severity": "medium",
    "description": "Web login or credential submission over clear-text HTTP instead of HTTPS.",
    "mitre": ["T1552"],
    "tags": ["network", "cleartext", "credentials"],
    "conditions": [
      { "field": "protocol", "operator": "equals", "value": "http" },
      { "field": "uri", "operator": "contains", "value": "login" }
    ]
  }
]
