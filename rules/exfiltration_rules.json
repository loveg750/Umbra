[
  {
    "id": "USB_DATA_EXFIL_01",
    "name": "USB Data Exfiltration",
    "log_type": "exfiltration",
    "severity": "high",
    "description": "Sensitive files copied to removable USB storage in a short timeframe.",
    "mitre": ["T1052", "T1041"],
    "tags": ["exfiltration", "usb", "insider", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "exfiltration" },
      { "field": "event", "operator": "contains", "value": "usb data exfiltration" }
    ]
  },
  {
    "id": "STEGO_EXFIL_01",
    "name": "Steganography-Based Exfiltration",
    "log_type": "exfiltration",
    "severity": "critical",
    "description": "Data hidden inside images or media and then transferred to an external location.",
    "mitre": ["T1020", "T1041"],
    "tags": ["exfiltration", "steganography", "advanced", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "exfiltration" },
      { "field": "event", "operator": "contains", "value": "steganography-based exfiltration" }
    ]
  },
  {
    "id": "CLOUD_EXFIL_01",
    "name": "Cloud Storage Data Exfiltration",
    "log_type": "exfiltration",
    "severity": "high",
    "description": "Sensitive files accessed locally and then uploaded to personal or unapproved cloud storage services.",
    "mitre": ["T1567", "T1041"],
    "tags": ["exfiltration", "cloud", "insider", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "exfiltration" },
      { "field": "event", "operator": "contains", "value": "cloud storage data exfiltration" }
    ]
  },
  {
    "id": "EMAIL_EXFIL_01",
    "name": "Email-Based Data Exfiltration",
    "log_type": "exfiltration",
    "severity": "high",
    "description": "Sensitive files sent to personal or external email addresses with misleading subjects.",
    "mitre": ["T1048", "T1567"],
    "tags": ["exfiltration", "email", "insider", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "exfiltration" },
      { "field": "event", "operator": "contains", "value": "email-based data exfiltration" }
    ]
  },
  {
    "id": "MASS_COMPRESSION_EXFIL_PREP_01",
    "name": "Mass Compression Before Exfiltration",
    "log_type": "exfiltration",
    "severity": "high",
    "description": "Unusual spike in archive file creation (ZIP, RAR, 7z) targeting directories with sensitive data.",
    "mitre": ["T1560", "T1020"],
    "tags": ["exfiltration", "staging", "archives", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "exfiltration" },
      { "field": "event", "operator": "contains", "value": "mass compression before exfiltration" }
    ]
  },
  {
    "id": "DNS_TUNNELING_EXFIL_01",
    "name": "DNS Tunneling for Data Exfiltration",
    "log_type": "exfiltration",
    "severity": "critical",
    "description": "High volume of long, encoded-looking DNS queries indicative of tunneling.",
    "mitre": ["T1071.004", "T1041"],
    "tags": ["exfiltration", "dns-tunnel", "covert-channel", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "exfiltration" },
      { "field": "event", "operator": "contains", "value": "dns tunneling for data exfiltration" }
    ]
  },
  {
    "id": "C2_EXFIL_CHAIN_01",
    "name": "C2 and Exfiltration Over Same Channel",
    "log_type": "exfiltration",
    "severity": "critical",
    "description": "Host communicates periodically with a suspected C2 server and later sends a large outbound transfer to the same endpoint.",
    "mitre": ["T1041", "T1105"],
    "tags": ["exfiltration", "c2", "botnet", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "exfiltration" },
      { "field": "event", "operator": "contains", "value": "c2 and exfiltration over same channel" }
    ]
  },
  {
    "id": "DB_BULK_EXFIL_01",
    "name": "Bulk Database Export",
    "log_type": "exfiltration",
    "severity": "critical",
    "description": "Full-table or large-scale export of sensitive database tables in a short timeframe.",
    "mitre": ["T1530", "T1041"],
    "tags": ["exfiltration", "database", "bulk-export", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "exfiltration" },
      { "field": "event", "operator": "contains", "value": "bulk database export" }
    ]
  },
  {
    "id": "SCREENSHOT_EXFIL_01",
    "name": "Screenshot-Based Data Theft",
    "log_type": "exfiltration",
    "severity": "medium",
    "description": "Extensive or repetitive screenshot activity on sensitive systems, especially followed by upload or removable media access.",
    "mitre": ["T1113", "T1052"],
    "tags": ["exfiltration", "screenshot", "visual-theft", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "exfiltration" },
      { "field": "event", "operator": "contains", "value": "screenshot-based data theft" }
    ]
  },
  {
    "id": "CLIPBOARD_EXFIL_01",
    "name": "Clipboard Data Exfiltration",
    "log_type": "exfiltration",
    "severity": "medium",
    "description": "Repeated copying of sensitive data into clipboard followed by paste actions into external or browser applications.",
    "mitre": ["T1115", "T1041"],
    "tags": ["exfiltration", "clipboard", "manual", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "exfiltration" },
      { "field": "event", "operator": "contains", "value": "clipboard data exfiltration" }
    ]
  },
  {
    "id": "INSIDER_EXFIL_DEPARTING_01",
    "name": "Departing Employee Data Exfiltration",
    "log_type": "exfiltration",
    "severity": "high",
    "description": "User with known departure or offboarding status demonstrating abnormal file access and transfer behavior.",
    "mitre": ["T1531", "T1078", "T1052"],
    "tags": ["exfiltration", "insider", "departing-employee", "scenario"],
    "conditions": [
      { "field": "log_type", "operator": "equals", "value": "exfiltration" },
      { "field": "event", "operator": "contains", "value": "departing employee data exfiltration" }
    ]
  },

  {
    "id": "EXFIL_SCENARIO_LABEL_GENERIC_01",
    "name": "Labeled Exfiltration Scenario (Training Data)",
    "log_type": "exfiltration",
    "severity": "high",
    "description": "Row in a labeled dataset marked as an exfiltration scenario (e.g., TP_USB_EXFIL, TP_CLOUD_EXFIL).",
    "mitre": ["T1041", "T1567"],
    "tags": ["exfiltration", "labeled-data", "scenario"],
    "conditions": [
      { "field": "scenario_label", "operator": "contains", "value": "exfil" }
    ]
  },
  {
    "id": "EXFIL_USB_TRAINING_ROW_01",
    "name": "USB Exfiltration with Sensitive Hits",
    "log_type": "exfiltration",
    "severity": "critical",
    "description": "Large outbound USB transfer with multiple sensitive hits, typical of labeled USB exfil scenarios.",
    "mitre": ["T1052", "T1041"],
    "tags": ["exfiltration", "usb", "training-set"],
    "conditions": [
      { "field": "channel", "operator": "equals", "value": "usb" },
      { "field": "sensitive_hits", "operator": "greater_than", "value": 0 },
      { "field": "bytes_out", "operator": "greater_than", "value": 50000000 }
    ]
  },
  {
    "id": "EXFIL_CLOUD_TRAINING_ROW_01",
    "name": "Cloud Exfiltration with Sensitive Hits",
    "log_type": "exfiltration",
    "severity": "critical",
    "description": "Large outbound cloud transfer with multiple sensitive hits, consistent with cloud exfiltration activity.",
    "mitre": ["T1567", "T1041"],
    "tags": ["exfiltration", "cloud", "training-set"],
    "conditions": [
      { "field": "channel", "operator": "equals", "value": "cloud" },
      { "field": "sensitive_hits", "operator": "greater_than", "value": 0 },
      { "field": "bytes_out", "operator": "greater_than", "value": 50000000 }
    ]
  },
  {
    "id": "EXFIL_LARGE_BYTES_GENERIC_01",
    "name": "Large Outbound Transfer (Generic Exfil Spike)",
    "log_type": "exfiltration",
    "severity": "high",
    "description": "Single record with very large outbound bytes, indicating a possible bulk data transfer.",
    "mitre": ["T1041", "T1567"],
    "tags": ["exfiltration", "egress-spike", "generic"],
    "conditions": [
      { "field": "bytes_out", "operator": "greater_than", "value": 100000000 }
    ]
  }
]
