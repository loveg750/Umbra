{
  "rules": [
    {
      "rule_id": "AUTH_BRUTE_FORCE_01",
      "name": "Single-Account Brute Force Attack",
      "log_type": "auth",
      "severity": "high",
      "description": "Multiple failed logins for the same account in a short time window, followed by a success.",
      "mitre": ["T1110", "T1078"],
      "pattern": {
        "group_by": "user",
        "min_failures": 5,
        "max_window_minutes": 10,
        "require_success_after": true
      },
      "umbra_summary": "Account {{user}} experienced repeated failed logins followed by a successful authentication. This aligns with brute force or password guessing behavior.",
      "recommended_action": "Lock or monitor the account, reset credentials, and review source IPs for malicious activity."
    },
    {
      "rule_id": "AUTH_PASSWORD_SPRAY_01",
      "name": "Password Spraying Attack",
      "log_type": "auth",
      "severity": "high",
      "description": "Single IP attempting logins against many different accounts with common passwords.",
      "mitre": ["T1110"],
      "pattern": {
        "group_by": "source_ip",
        "min_attempts": 15,
        "min_distinct_users": 10,
        "max_window_minutes": 5,
        "max_success_ratio": 0.3
      },
      "umbra_summary": "High-volume failed login attempts from {{source_ip}} across multiple accounts indicate a password spraying attempt.",
      "recommended_action": "Block or rate-limit the source IP, enforce MFA, and reset or monitor affected accounts."
    },
    {
      "rule_id": "AUTH_CREDENTIAL_STUFFING_01",
      "name": "Credential Stuffing Activity",
      "log_type": "auth",
      "severity": "high",
      "description": "Large number of login attempts using known or leaked credential pairs.",
      "mitre": ["T1110", "T1078"],
      "pattern": {
        "group_by": "source_ip",
        "min_attempts": 20,
        "min_distinct_users": 5,
        "indicator_leaked_creds": true
      },
      "umbra_summary": "Login attempts from {{source_ip}} match patterns associated with use of leaked credentials.",
      "recommended_action": "Block the source IP, check for accounts that successfully authenticated, and force password resets for those users."
    },
    {
      "rule_id": "AUTH_IMPOSSIBLE_TRAVEL_01",
      "name": "Impossible Travel Detection",
      "log_type": "auth",
      "severity": "high",
      "description": "Same user logging in from geographically distant locations in an unrealistically short period of time.",
      "mitre": ["T1078"],
      "pattern": {
        "user_based": true,
        "min_distance_km": 2000,
        "max_time_minutes": 20
      },
      "umbra_summary": "User {{user}} authenticated from distant locations within a time frame that makes legitimate travel impossible. This suggests session hijack or credential theft.",
      "recommended_action": "Terminate existing sessions, force password reset, and monitor for further suspicious logins."
    },
    {
      "rule_id": "AUTH_VPN_ANOMALY_01",
      "name": "Anomalous VPN Login",
      "log_type": "vpn",
      "severity": "high",
      "description": "VPN login from a high-risk or previously unseen country, particularly near another login from a different region.",
      "mitre": ["T1078"],
      "pattern": {
        "user_based": true,
        "new_country_only": true,
        "high_risk_country": true,
        "max_time_from_last_login_minutes": 30
      },
      "umbra_summary": "User {{user}} connected via VPN from a new or high-risk country inconsistent with known behavior.",
      "recommended_action": "Review session details, verify user intent, and restrict or challenge access from that location."
    },
    {
      "rule_id": "AUTH_MFA_FATIGUE_01",
      "name": "MFA Fatigue Attack",
      "log_type": "auth",
      "severity": "high",
      "description": "Multiple repeated MFA push notifications followed by an approval, suggesting the user accepted due to fatigue.",
      "mitre": ["T1621"],
      "pattern": {
        "event_type_push": "MFA_PUSH",
        "event_type_approve": "MFA_APPROVED",
        "min_push_count": 5,
        "max_window_minutes": 2
      },
      "umbra_summary": "User {{user}} received repeated MFA prompts in quick succession and eventually approved one, indicating a likely MFA fatigue attack.",
      "recommended_action": "Invalidate current sessions, require secure re-authentication, and educate the user about MFA fatigue attacks."
    },
    {
      "rule_id": "AUTH_DARKWEB_LEAK_01",
      "name": "Dark Web Credential Exposure",
      "log_type": "intel",
      "severity": "high",
      "description": "User’s credentials were found in an external breach feed and the password is still in active use internally.",
      "mitre": ["T1078"],
      "pattern": {
        "source": "DarkWebMonitor",
        "event_type": "LEAK_DETECTED",
        "password_still_active": true
      },
      "umbra_summary": "Credentials for user {{user}} have been discovered in an external breach source and are still valid internally.",
      "recommended_action": "Force password reset, enable or enforce MFA, and monitor for suspicious login behavior."
    },
    {
      "rule_id": "AUTH_UNAUTHORIZED_ADMIN_CREATION_01",
      "name": "Shadow Admin Account Creation",
      "log_type": "auth_admin",
      "severity": "critical",
      "description": "New administrator-level account created without a corresponding change ticket or outside normal administrative windows.",
      "mitre": ["T1136"],
      "pattern": {
        "new_account": true,
        "privilege_level": "admin",
        "requires_ticket": true,
        "ticket_found": false,
        "off_hours": true
      },
      "umbra_summary": "A new admin-level account {{new_account_name}} was created outside authorized channels, which is consistent with creation of a shadow admin.",
      "recommended_action": "Disable the new account, review the creator’s activity, and confirm whether any change request exists."
    },
    {
      "rule_id": "AUTH_PRIV_BEHAVIOR_DEVIATION_01",
      "name": "Privileged User Behavior Deviation",
      "log_type": "auth",
      "severity": "high",
      "description": "Privileged account performing actions outside its normal behavioral baseline.",
      "mitre": ["T1078", "T1098"],
      "pattern": {
        "user_based": true,
        "user_role": "admin",
        "deviation_score_threshold": 0.8
      },
      "umbra_summary": "Privileged account {{user}} is performing actions that differ significantly from its historical behavior profile.",
      "recommended_action": "Review recent activity by this privileged account, verify the user identity, and consider temporarily restricting sensitive operations."
    },
    {
      "rule_id": "AUTH_DEPARTING_EMPLOYEE_01",
      "name": "Departing Employee Access Risk",
      "log_type": "auth",
      "severity": "high",
      "description": "User within an offboarding window displaying unusual access and file retrieval behavior.",
      "mitre": ["T1531", "T1078"],
      "pattern": {
        "user_in_offboarding_window_days": 14,
        "spike_in_file_access": true,
        "after_hours_activity": true,
        "usb_or_cloud_activity": true
      },
      "umbra_summary": "User {{user}} is approaching departure and shows increased after-hours access and data movement activity.",
      "recommended_action": "Monitor account closely, restrict access to sensitive resources, and shorten remaining access window if appropriate."
    },
    {
      "rule_id": "AUTH_ZERO_DAY_AUTH_BYPASS_01",
      "name": "Zero-Day Authentication Bypass Behavior",
      "log_type": "auth",
      "severity": "critical",
      "description": "Authentication succeeded under anomalous conditions such as unknown opcode errors and skipped MFA.",
      "mitre": ["T1556"],
      "pattern": {
        "unknown_error_opcode": true,
        "auth_success_without_mfa": true,
        "privileged_session_opened": true
      },
      "umbra_summary": "Authentication system displayed anomalous behavior leading to successful privileged login without MFA. This is consistent with an authentication bypass or zero-day exploit.",
      "recommended_action": "Immediately restrict access to the affected authentication system, rotate critical credentials, and escalate to incident response for in-depth investigation."
    },
    {
      "rule_id": "AUTH_ANOMALOUS_LOGIN_TIME_01",
      "name": "Anomalous Login Time",
      "log_type": "auth",
      "severity": "medium",
      "description": "User logs in at a time significantly outside their usual working hours.",
      "mitre": ["T1078"],
      "pattern": {
        "user_based": true,
        "outside_baseline_hours": true,
        "require_previous_normal_hours_baseline": true
      },
      "umbra_summary": "User {{user}} authenticated at an unusual time that does not match established behavior patterns.",
      "recommended_action": "Verify whether the user initiated this session and correlate with other activity to determine risk level."
    },
    {
      "rule_id": "AUTH_MULTIPLE_ACCOUNT_LOCKOUTS_01",
      "name": "Multiple Account Lockouts",
      "log_type": "auth",
      "severity": "medium",
      "description": "Several accounts become locked out in a short period, possibly due to coordinated guessing attacks.",
      "mitre": ["T1110"],
      "pattern": {
        "event_type": "ACCOUNT_LOCKOUT",
        "min_accounts_locked": 5,
        "max_window_minutes": 10
      },
      "umbra_summary": "Multiple accounts were locked out within a short timeframe, which may indicate ongoing password guessing activity.",
      "recommended_action": "Investigate source IPs involved, implement IP throttling, and inform affected users."
    }
  ]
}
